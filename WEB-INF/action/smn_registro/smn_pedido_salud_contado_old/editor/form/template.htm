<!doctype html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<link rel="stylesheet" type="text/css" href="${def:context}/dinamica_bkp.css" />
	<link rel="stylesheet" type="text/css" href="${def:context}/main.css" />
	<link rel="stylesheet" type="text/css" href="${def:context}/select2.min.css" />
	
	<!--biblioteca generica JS/Dinamica-->
	<script type="text/javascript" src="${def:context}/action/script"></script>
	<script type="text/javascript" src="${def:context}/action/jquery"></script>
	<script type="text/javascript" src="${def:context}/action/select2"></script>
</head>
<body>
<!--banner-->
<div class="bannerDialog" id="encabezado_tabla">
	Generando un Pedido
	<img src="${def:context}/images/close.png" class="button" onclick="parent.closeDialog(); parent.search();" title="${lbl:b_close_button}" style="float:right; cursor:pointer;">
	${req:progress}
</div>

<!--formulario addnew/edit-->
<form name="form1" id="form1" onsubmit="return save();" style="width:500px;">
	<!-- titulo -->
	<h1 id="formTitle"></h1>
	<table>
		<!--ancho de la columna de etiquetas-->
		<col width="30%">
	<tr>
		<td>${lbl:b_centro_facturacion}</td>
		<td>
			<select name="smn_centro_facturacion_id" id="smn_centro_facturacion_id" onchange="chgCombo1(smn_centro_facturacion_id.options[smn_centro_facturacion_id.selectedIndex].text,'smn_centro_facturacion_id_name');">
				<option value="">[Cualquiera]</option>
				<smn_centro_facturacion_id_rows>
				<option value="${fld:id}">${fld:item}</option>

				</smn_centro_facturacion_id_rows>
			</select> 
			<input id="smn_centro_facturacion_id_name" name="smn_centro_facturacion_id_name" type="hidden">
		</td>
	</tr>
	<tr>
		<td>${lbl:b_sub_centro_facturacion}</td>
		<td>
			<select name="smn_sub_centro_facturacion_id" id="smn_sub_centro_facturacion_id" onchange="chgCombo(smn_sub_centro_facturacion_id.options[smn_sub_centro_facturacion_id.selectedIndex].text,'smn_sub_centro_facturacion_id_name');">
				<option value="">[Cualquiera]</option>
				<smn_sub_centro_facturacion_id_rows>
				<option value="${fld:id}">${fld:item}</option>

				</smn_sub_centro_facturacion_id_rows>
			</select> 
			<input id="smn_sub_centro_facturacion_id_name" name="smn_sub_centro_facturacion_id_name" type="hidden">
		</td>
	</tr>
	<tr>
		<td>${lbl:b_customer}*</td>
		<td>
			<select class="cliente" name="smn_cliente_id" id="smn_cliente_id" onchange="chgCombo(smn_cliente_id.options[smn_cliente_id.selectedIndex].text,'smn_cliente_id_name');bloquearcombos();">
				<option value="1">[Cualquiera]</option>
				<smn_cliente_id_rows>
				<option value="${fld:id}">${fld:item}</option>

				</smn_cliente_id_rows>
			</select> 
			<input id="smn_cliente_id_name" name="smn_cliente_id_name" type="hidden">
		</td>
			<!-- Incorporado manualmente para mostrar icono de inclusion de elementos al combo -->
		<td>
			<img src="${def:context}/images/list-add2.png" align="left" class="button" onclick="cliente()" title="CLIENTE" >
		</td>
		<td>
			&nbsp;&nbsp;
		</td>
	</tr>
	<tr>
		<td>Paciente*</td>
		<td>
			<select class="js-example-basic-single" name="smn_auxiliar_rf" id="smn_auxiliar_rf" onchange="chgCombo(smn_auxiliar_rf.options[smn_auxiliar_rf.selectedIndex].text,'smn_auxiliar_rf_name');bloquearcombos1();">
				<option value="">[Cualquiera]</option>
				<smn_auxiliar_rf_rows>
				<option value="${fld:id}">${fld:item}</option>

				</smn_auxiliar_rf_rows>
			</select>
			<input id="smn_auxiliar_rf_name" name="smn_auxiliar_rf_name" type="hidden">
		</td>
			<!-- Incorporado manualmente para mostrar icono de inclusion de elementos al combo -->
		<td>
			<img src="${def:context}/images/list-add2.png" align="left" class="button" onclick="comprador()" title="${lbl:b_buyer}" >
		</td>
		<td>
			&nbsp;&nbsp;
		</td>
	</tr>
	</table>
	<!--botones-->
	<input id="grabar" type="submit" name="grabar" value="${lbl:b_save_button}" class="button">
	<input id="salir" type="button" value="${lbl:s_exit}" onclick="parent.closeDialog(); parent.search();" class="button">	
	<!-- PK-->
	<input type="hidden" name="id" value="">
</form>

<!--FORMULARIO PEDIDO PUNTO DE VENTA DETALLE-->
<form name="form2" id="form2" onsubmit="return save2()" style="width:850px;">
	<!-- titulo -->
	<h1 id="formTitle">${lbl:b_add_record}</h1>
	<table>
		<!--ancho de la columna de etiquetas-->
		<col width="30%">
		<!--campos style="display:none"-->
	<tr>
		<td>${lbl:b_header_order}*</td>
		<td>
			<input id="smn_pedido_cabecera_id" name="smn_pedido_cabecera_id" type="text" maxlength="10" class="numeric">
		</td>
		<td>${lbl:b_nature}*</td>
		<td>
			<select class="js-example-basic-single" name="pde_naturaleza" id="pde_naturaleza" onchange="cambiartipo();">
				<option value="">[Cualquiera]</option>
				<option value="IT">${lbl:b_item}</option>
				<option value="SE">${lbl:b_services}</option>
				<option value="AF">${lbl:b_actfijo}</option>
			</select> 
		</td>
	</tr>

	<tr style="display: none">
	<td>${lbl:b_catalog_item_commerce}*</td>
	<td>
		<select name="smn_catalogo_item_comercio_id" id="smn_catalogo_item_comercio_id" onchange="chgCombo2(smn_catalogo_item_comercio_id.options[smn_catalogo_item_comercio_id.selectedIndex].text,'smn_catalogo_item_comercio_id_name');chgCombo3(smn_catalogo_item_comercio_id.options[smn_catalogo_item_comercio_id.selectedIndex].text,'smn_catalogo_item_comercio_id_name');">
			<option value="">[Cualquiera]</option>
			<smn_catalogo_item_comercio_id_rows>
			<option value="${fld:id}">${fld:item}</option>

			</smn_catalogo_item_comercio_id_rows>
		</select> 
		<input id="smn_catalogo_item_comercio_id_name" name="smn_catalogo_item_comercio_id_name" type="hidden">
	</td>
	</tr>
	<tr style="display: none">
		<td>${lbl:b_ingredients}</td>
		<td id="ing">
			<!-- <smn_ingredientes_id_rows>
			<input name="smn_ingredientes_id" id="smn_ingredientes_id" type="checkbox" value="${fld:smn_ingredientes_id}" style="width:10px"> ${fld:item}<br>
			</smn_ingredientes_id_rows> -->
			</td>
	</tr>

	<tr style="display: none">
		<td>${lbl:b_description}*</td>
		<td>
			<input id="smn_descripcion_ingrediente" name="smn_descripcion_ingrediente" type="text" maxlength="200" disabled="true">
		</td>
	</tr>
	<tr style="display: none">
		<td>${lbl:b_measurement_unit}*</td>
		<td>
			<select name="smn_unidad_medida_rf" id="smn_unidad_medida_rf" onchange="chgCombo(smn_unidad_medida_rf.options[smn_unidad_medida_rf.selectedIndex].text,'smn_unidad_medida_rf_name');">
				<option value="">[Cualquiera]</option>
				<smn_unidad_medida_rf_rows>
				<option value="${fld:id}">${fld:item}</option>

				</smn_unidad_medida_rf_rows>
			</select> 
			<input id="smn_unidad_medida_rf_name" name="smn_unidad_medida_rf_name" type="hidden">
		</td>
	</tr>
	<tr  style="display: none">
		<td>${lbl:b_time_suggerest_prepared}*</td>
		<td>
			<input id="pde_tiempo_sug_preparacion" name="pde_tiempo_sug_preparacion" type="text" maxlength="8" placeholder="Escribir el tiempo expresado en minutos" >
		</td>
	</tr>
	
	<tr  id="serv">
		<td>${lbl:b_services}</td>
		<td>
			<select class="js-example-basic-single" name="smn_servicios_rf" id="smn_servicios_rf" onchange="chgCombo(smn_servicios_rf.options[smn_servicios_rf.selectedIndex].text,'smn_servicios_rf_name'); obtenerprecio2(smn_servicios_rf.options[smn_servicios_rf.selectedIndex].text,'smn_servicios_rf_name');">
				<option value="">[Cualquiera]</option>
				<smn_servicios_rf_rows>
				<option value="${fld:id}">${fld:item}</option>

				</smn_servicios_rf_rows>
			</select> 
			<input id="smn_servicios_rf_name" name="smn_servicios_rf_name" type="hidden">
		</td>
	</tr>
	<tr id="ite">
		<td>${lbl:b_item}</td>
		<td>
			<select class="js-example-basic-single" name="smn_item_rf" id="smn_item_rf" onchange="chgCombo(smn_item_rf.options[smn_item_rf.selectedIndex].text,'smn_item_rf_name'); obtenerprecio(smn_item_rf.options[smn_item_rf.selectedIndex].text,'smn_item_rf_name');" style="width: 100%">
				<option value="">[Cualquiera]</option>
				<smn_item_rf_rows>
				<option value="${fld:id}">${fld:item}</option>

				</smn_item_rf_rows>
			</select> 
			<input id="smn_item_rf_name" name="smn_item_rf_name" type="hidden">
		</td>
	</tr>
	<tr id="act" style="display:none">
		<td>${lbl:b_actfijo}</td>
		<td>
			<select name="smn_activo_fijo_rf" id="smn_activo_fijo_rf" onchange="chgCombo(smn_activo_fijo_rf.options[smn_activo_fijo_rf.selectedIndex].text,'smn_activo_fijo_rf_name');">
				<option value="">[Cualquiera]</option>
				<smn_activo_fijo_rf_rows>
				<option value="${fld:id}">${fld:item}</option>

				</smn_activo_fijo_rf_rows>
			</select> 
			<input id="smn_activo_fijo_rf_name" name="smn_activo_fijo_rf_name" type="hidden">
		</td>
	</tr>
	<tr style="display:none">
		<td>${lbl:b_quantity_offer}</td>
		<td>
			<input id="pde_cantidad_oferta" name="pde_cantidad_oferta" type="text" maxlength="10" class="numeric">
		</td>
	</tr>
	<tr>
		<td>${lbl:b_quantity_order}*</td>
		<td>
			<input id="pde_cantidad_pedido" name="pde_cantidad_pedido" type="text" maxlength="10" class="numeric" onchange="verificarcantidad();">
		</td>
	</tr>
	<tr style="display:none">
		<td>${lbl:b_quantity_aprob}*</td>
		<td>
			<input id="pde_cantidad_aprobada" name="pde_cantidad_aprobada" type="text" maxlength="10" class="numeric" disabled="true">
		</td>
	</tr>
	<tr>
		<td>${lbl:b_price}*</td>
		<td>
			<input id="pde_precio" name="pde_precio" type="text" maxlength="30" class="numeric" onblur="calcular_monto();">
		</td>
		<td>${lbl:b_amount}*</td>
		<td>
			<input id="pde_monto" name="pde_monto" type="text" maxlength="30" class="numeric">
		</td>
	</tr>
	<tr id="moneda" style="display:none">
		<td>${lbl:b_coins}</td>
		<td>
			<select name="smn_moneda_rf" id="smn_moneda_rf" onchange="chgCombo(smn_moneda_rf.options[smn_moneda_rf.selectedIndex].text,'smn_moneda_rf_name');">
				<option value="">[Cualquiera]</option>
				<smn_moneda_rf_rows>
				<option value="${fld:id}">${fld:item}</option>

				</smn_moneda_rf_rows>
			</select> 
			<input id="smn_moneda_rf_name" name="smn_moneda_rf_name" type="hidden">
		</td>
	</tr>
	<tr id="tasa" style="display:none">
		<td>${lbl:b_exchange_rate}</td>
		<td>
			<select name="smn_tasa_rf1" id="smn_tasa_rf1" onchange="chgCombo(smn_tasa_rf1.options[smn_tasa_rf.selectedIndex].text,'smn_tasa_rf1_name');">
				<option value="">[Cualquiera]</option>
				<smn_tasa_rf_rows1>
				<option value="${fld:id}">${fld:item}</option>

				</smn_tasa_rf_rows1>
			</select> 
			<input id="smn_tasa_rf1_name" name="smn_tasa_rf1_name" type="hidden">
		</td>
	</tr>
	<tr id="prec_alt" style="display:none">
		<td>${lbl:b_price_coins_alter}</td>
		<td>
			<input id="pde_precio_moneda_alterna" name="pde_precio_moneda_alterna" type="text" maxlength="30" class="numeric" onblur="calcular_monto_ma();">
		</td>
	<!-- </tr>
	<tr id="mont_alt" style="display:none"> -->
		<td>Monto MA</td>
		<td>
			<input id="pde_monto_moneda_alterna" name="pde_monto_moneda_alterna" type="text" maxlength="30" class="numeric">
		</td>
	</tr>
	<tr style="display:none">
		<td>${lbl:b_especifications}</td>
		<td>
			<textarea id="pde_especificaciones_pedido" name="pde_especificaciones_pedido" cols="30" rows="3"></textarea>
		</td>
	</tr>
	<tr style="display:none">
		<td>${lbl:b_required_date}*</td>
		<td>
			<input id="pde_fecha_requerida" name="pde_fecha_requerida" type="text" class="date" maxlength="10">
			<img src="${def:context}/images/dropdown.png" title="Desplegar calendario" onclick="calendarOpen('pde_fecha_requerida')">
		</td>
	</tr>
	<tr style="display:none">
		<td>${lbl:b_observations}</td>
		<td>
			<textarea id="pde_observaciones" name="pde_observaciones" cols="30" rows="3"></textarea>
		</td>
	</tr>
	<tr style="display: none">
		<td>${lbl:b_status}*</td>
		<td>
			<select name="pde_estatus" id="pde_estatus">
			<option value="NP">${lbl:b_not_borrowed}</option>
			<option value="PR">${lbl:b_borrowed}</option>

			</select> 
		</td>
	</tr>

	</table>

	<!--botones-->
	<input id="grabar2" name="grabar2" type="submit" value="${lbl:b_save_button}" class="button add-row">
	<input id="pagar" type="button" value="Pagar" onclick="pago()" class="button">	
	<input id="salir" type="button" value="${lbl:s_exit}" onclick="parent.closeDialog(); parent.search();" class="button">	

	<!-- PK-->
<input type="hidden" name="id" value="">
<input type="hidden" name="empresa" id="empresa">
<input type="hidden" name="linea" id="linea">
<input type="hidden" name="baremos" id="baremos">
<input type="hidden" name="divisa2" id="divisa2">
<input type="hidden" name="item" id="item">
<input type="hidden" name="cantidad" id="cantidad">
<input type="hidden" name="centro" id="centro">

</form>

<!--formulario addnew/edit-->
<form name="form3" id="form3" onsubmit="return save3()" style="width:500px;">
	<!-- titulo -->
	<h1 id="formTitle">${lbl:b_add_record}</h1>
	<table>
		<!--ancho de la columna de etiquetas-->
		<col width="30%">
		<tr>
			<td width="10%">${lbl:b_header_order}</td>
			<td><input id="pedido" name="pedido" type="text" maxlength="10" class="numeric" readonly disabled="true"></td>
		</tr>
		<tr>
			<td width="10%">${lbl:b_customer}</td>
			<td><input id="cliente" name="cliente" type="text" maxlength="100" readonly disabled="true"></td>
		</tr>
		
		<tr style="display: none">
			<td>${lbl:b_header_order}*</td>
			<td>
				<input id="smn_pedido_cabecera_id" name="smn_pedido_cabecera_id" type="text" maxlength="10" class="numeric">
			</td>
		</tr>
		<tr style="display: none">
			<td>${lbl:b_movement_caj}*</td>
			<td>
				<input id="smn_mov_caja_cabecera_id" name="smn_mov_caja_cabecera_id" type="text" maxlength="10" class="numeric">
			</td>
		</tr>
		<tr style="display: none">
			<td>${lbl:b_class_auxiliary}*</td>
			<td>
				<select name="smn_pagador_clase_rf" id="smn_pagador_clase_rf" onchange="chgCombo(smn_pagador_clase_rf.options[smn_pagador_clase_rf.selectedIndex].text,'smn_pagador_clase_rf_name');">
					<option value="">[Cualquiera]</option>
					<smn_pagador_clase_rf_rows>
					<option value="${fld:id}">${fld:item}</option>

					</smn_pagador_clase_rf_rows>
				</select> 
				<input id="smn_pagador_clase_rf_name" name="smn_pagador_clase_rf_name" type="hidden">
			</td>
		</tr>
		<tr>
			<td>${lbl:b_way_to_pay}</td>
			<td>
				<!-- <select name="smn_forma_pago_rf" id="smn_forma_pago_rf" onchange="chgCombo12(smn_forma_pago_rf.options[smn_forma_pago_rf.selectedIndex].text,'smn_forma_pago_rf_name');requiere_banco(smn_forma_pago_rf.options[smn_forma_pago_rf.selectedIndex].text,'smn_forma_pago_rf_name');chgCombo15(smn_forma_pago_rf.options[smn_forma_pago_rf.selectedIndex].text,'smn_forma_pago_rf_name');chgCombo16(smn_forma_pago_rf.options[smn_forma_pago_rf.selectedIndex].text,'smn_forma_pago_rf_name');"> -->
					<select class="formapago" name="smn_forma_pago_rf" id="smn_forma_pago_rf"  onchange="chgCombo16(smn_forma_pago_rf.options[smn_forma_pago_rf.selectedIndex].text,'smn_forma_pago_rf_name');chgCombo15(smn_forma_pago_rf.options[smn_forma_pago_rf.selectedIndex].text,'smn_forma_pago_rf_name');">
					<option value="">[Cualquiera]</option>
					<smn_forma_pago_rf_rows>
					<option value="${fld:id}">${fld:item}</option>

					</smn_forma_pago_rf_rows>
				</select> 
				<input id="smn_forma_pago_rf_name" name="smn_forma_pago_rf_name" type="hidden">
			</td>
		</tr>
		<tr id="bancorig">
			<td>Banco Origen*</td>
			<td>
				<select class="bank_orig" name="ppv_banco_origen" id="ppv_banco_origen" onchange="chgCombo(ppv_banco_origen.options[ppv_banco_origen.selectedIndex].text,'ppv_banco_origen_name');">
					<option value="">[Cualquiera]</option>
					<ppv_banco_origen_rows>
					<option value="${fld:id}">${fld:item}</option>

					</ppv_banco_origen_rows>
				</select> 
				<input id="ppv_banco_origen_name" name="ppv_banco_origen_name" type="hidden">
			</td>
		</tr>
		<tr id="bancodesti">
			<td>Banco Destino*</td>
			<td>
				<select class="bank_dest" name="ppv_banco_destino" id="ppv_banco_destino" onchange="chgCombo_bancaria(ppv_banco_destino.options[ppv_banco_destino.selectedIndex].text,'ppv_banco_destino_name');">
					<option value="">[Cualquiera]</option>
					<ppv_banco_destino_rows>
					<option value="${fld:id}">${fld:item}</option>

					</ppv_banco_destino_rows>
				</select> 
				<input id="ppv_banco_destino_name" name="ppv_banco_destino_name" type="hidden">
			</td>
		</tr>

		<tr id="cuentaban">
			<td>Cuenta Bancaria*</td>
			<td>
				<select class="account_bank" name="ppv_cuenta_bancaria" id="ppv_cuenta_bancaria" onchange="chgCombo(ppv_cuenta_bancaria.options[ppv_cuenta_bancaria.selectedIndex].text,'ppv_cuenta_bancaria_name');">
					<option value="">[Cualquiera]</option>
					<ppv_cuenta_bancaria_rows>
					<option value="${fld:id}">${fld:item}</option>

					</ppv_cuenta_bancaria_rows>
				</select> 
				<input id="ppv_cuenta_bancaria_name" name="ppv_cuenta_bancaria_name" type="hidden">
			</td>
		</tr>
		<tr id="med_pag">
			<td>${lbl:b_media_payment}</td>
			<td>
				<select name="smn_rel_punto_venta_pago_rf" id="smn_rel_punto_venta_pago_rf" onchange="chgCombo(smn_rel_punto_venta_pago_rf.options[smn_rel_punto_venta_pago_rf.selectedIndex].text,'smn_rel_punto_venta_pago_rf_name');">
					<option value="">[Cualquiera]</option>
					<smn_rel_punto_venta_pago_rf_rows>
					<option value="${fld:id}">${fld:item}</option>

					</smn_rel_punto_venta_pago_rf_rows>
				</select> 
				<input id="smn_rel_punto_venta_pago_rf_name" name="smn_rel_punto_venta_pago_rf_name" type="hidden">
			</td>
		</tr>
		<tr id="num_doc" style="display: none">
			<td>${lbl:b_number_doc_form_pay}</td>
			<td>
				<input id="ppv_numero_documento_forma_pago" name="ppv_numero_documento_forma_pago" type="text" maxlength="10" class="numeric">
			</td>
		</tr>
		<tr id="num_aut" style="display: none">
			<td>${lbl:b_number_autorization}</td>
			<td>
				<input id="ppv_numero_autorizacion" name="ppv_numero_autorizacion" type="text" maxlength="10" class="numeric">
			</td>
		</tr>
		
		<tr id="num_dep" style="display: none">
			<td>${lbl:b_number_deposit}*</td>
			<td>
				<textarea id="ppv_numero_deposito" name="ppv_numero_deposito" cols="5" rows="3"></textarea>
			</td>
		</tr>
		<tr id="doc_ident" style="display: none">
			<td>${lbl:b_document_identity}</td>
			<td>
				<input id="ppv_documento_identidad_pagador" name="ppv_documento_identidad_pagador" type="text" maxlength="100" >
			</td>
		</tr>
		<tr id="nom_pag" style="display: none">
			<td>${lbl:b_paying_name}</td>
			<td>
				<input id="ppv_nombre_pagador" name="ppv_nombre_pagador" type="text" maxlength="100" >
			</td>
		</tr>
		<tr id="coin">
		<td>${lbl:b_coins}</td>
		<td>
			<select class="moneda" name="smn_moneda_rf" id="smn_moneda_rf" onchange="chgCombo30(smn_moneda_rf.options[smn_moneda_rf.selectedIndex].text,'smn_moneda_rf_name'); activarmonedaalterna();">
				<option value="">[Cualquiera]</option>
				<smn_moneda_rf_rows>
				<option value="${fld:id}">${fld:item}</option>

				</smn_moneda_rf_rows>
			</select> 
			<input id="smn_moneda_rf_name" name="smn_moneda_rf_name" type="hidden">
		</td>
		</tr>
		<tr id="tasa3" style="display: none">
			<td>${lbl:b_exchange_rate}</td>
			<td>
				<select  class="tasa" name="smn_tasa_rf" id="smn_tasa_rf" onchange="chgCombo(smn_tasa_rf.options[smn_tasa_rf.selectedIndex].text,'smn_tasa_rf_name'); seteartasa(smn_tasa_rf.options[smn_tasa_rf.selectedIndex].text,'smn_tasa_rf_name');">
					<option value="">[Cualquiera]</option>
					<smn_tasa_rf_rows>
					<option value="${fld:id}">${fld:item}</option>

					</smn_tasa_rf_rows>
				</select> 
				<input id="smn_tasa_rf_name" name="smn_tasa_rf_name" type="hidden">
			</td>
		</tr>
		<tr  id="monto_pagar">
			<td>${lbl:b_amount_payment_ml}</td>
			<td>
				<input id="ppv_monto_pagar_ml" name="ppv_monto_pagar_ml" type="text" maxlength="30" class="numeric">
			</td>
		</tr>
		<tr id="monto_pago">
			<td>${lbl:b_amount_pay_ml}*</td>
			<td>
				<input id="ppv_monto_pago_ml" name="ppv_monto_pago_ml" type="text" maxlength="30" class="numeric" onchange="calcularvuelto();">
			</td>
		</tr>
		<tr  id="monto_vuelto">
			<td>${lbl:b_amount_revers_ml}</td>
			<td>
				<input id="ppv_monto_devuelto_ml" name="ppv_monto_devuelto_ml" type="text" maxlength="30" class="numeric">
			</td>
		</tr>
		<tr id="mo_pago" style="display: none">
			<td>${lbl:b_amount_pay_ma}</td>
			<td>
				<input id="ppv_monto_pago_ma" name="ppv_monto_pago_ma" type="text" maxlength="10" class="numeric">
			</td>
		</tr>
		<tr id="mo_pagar" style="display: none">
			<td>${lbl:b_amount_payment_ma}</td>
			<td>
				<input id="ppv_monto_pagar_ma" name="ppv_monto_pagar_ma" type="text" maxlength="30" class="numeric" onchange="calcular_pago();">
			</td>
		</tr>
		<tr id="mo_devo" style="display: none">
			<td>${lbl:b_amount_revers_ml}</td>
			<td>
				<input id="ppv_monto_devuelto_ma" name="ppv_monto_devuelto_ma" type="text" maxlength="30" class="numeric">
			</td>
		</tr>

		<tr style="display: none">
			<td>${lbl:b_observation}</td>
			<td>
				<textarea id="ppv_observacion" name="ppv_observacion" cols="30" rows="3"></textarea>
			</td>
		</tr>
		<tr style="display: none">
			<td>${lbl:b_status}*</td>
			<td>
				<select name="ppv_estatus" id="ppv_estatus">
				<option value="AC">${lbl:b_account_type_active}</option>
				<option value="IN">${lbl:b_inactive}</option>

				</select> 
			</td>
		</tr>
	</table>
	<!--botones-->
	<input id="grabar" type="submit" value="${lbl:b_save_button}" class="button">
 	<input id="procesar" type="button" value="Procesar" onclick="proceso()" class="button">
	<input id="salir" type="button" value="${lbl:s_exit}" onclick="parent.closeDialog(); parent.search();" class="button">	

<!-- PK-->
<input type="hidden" name="id" value="">
<input type="hidden" name="req_banco" id="req_banco">
<input type="hidden" name="id_pago" id="id_pago">
<input type="hidden" name="divisa" id="divisa">

</form>

<form id="form4" name="form4" style="display: none">
	<table class="datagrid" style="width:20%;">
		<tr>
			<td>
				<td>Monto ML
				<input align="center" id="montopagar" readonly disabled="true"></td>
			</td>
			<td>
				<td>Monto MA
				<input align="center" id="montopagarma" readonly disabled="true"></td>
			</td>
		</tr> 
	</table>
	<table class="datagrid" style="width:80%;" id="tabla4">
		<!-- <col width='2%'/> -->
		<col width='5%'/>
		<col width='14%'/>
		<col width='14%'/>
		<col width='14%'/>
		<col width='14%'/>
		<col width='14%'/>
		<col width='14%'/>
		<!-- <col width='14%'/> -->
		<tr>
			<th colspan="7" id="encabezado_tabla">
				Lista de detalle
			</th>
		</tr>

		<tr>
			<th></th>
			<th class='sortable' onclick='sortBy("catalogo","query-detalle.sql")'>Producto</th>
			<th class='sortable' onclick='sortBy("cantidad","query-detalle.sql")'>${lbl:b_quantity}</th>
			<th class='sortable' onclick='sortBy("pde_precio","query-detalle.sql")'>${lbl:b_price_ml}</th>
			<th class='sortable' onclick='sortBy("monto","query-detalle.sql")'>${lbl:b_amount_ml}</th>
			<th class='sortable' onclick='sortBy("precioma","query-detalle.sql")'>${lbl:b_price_ma}</th>
			<th class='sortable' onclick='sortBy("montoma","query-detalle.sql")'>${lbl:b_amount_ma}</th>
		</tr>
	
		</tr>
	</table>
</form>

<form id="form5" name="form5" style="display: none">
	<table class="datagrid" style="width:20%;">
		<tr>
			<td>
				<td>Monto ML
				<input align="center" id="montopagar" readonly disabled="true"></td>
			</td>
			<td>
				<td>Monto MA
				<input align="center" id="montopagarma" readonly disabled="true"></td>
			</td>
		</tr>
	</table>	
	<table class="datagrid" style="width:70%;" id="tabla5">
		<col width='5%'/>
		<col width='9%'/>
		<col width='9%'/>
		<col width='9%'/>
		<col width='9%'/>
		<col width='9%'/>
		<col width='9%'/>
		<col width='9%'/>
		<col width='9%'/>
		<col width='9%'/>
		<col width='9%'/>
		<tr>
			<th colspan="11" id="encabezado_tabla" >
				Lista de Pagos
			</th>
		</tr>
		</tr>
		    <th></th>
			<th class='sortable' onclick='sortBy("ppv_numero_documento_forma_pago","query-pago.sql")'>Forma de Pago</th>
			<th class='sortable' onclick='sortBy("ppv_numero_autorizacion","query-pago.sql")'>${lbl:b_number_autorization}</th>
			<th class='sortable' onclick='sortBy("ppv_documento_identidad_pagador","query-pago.sql")'>${lbl:b_document_identity}</th>
			<th class='sortable' onclick='sortBy("ppv_nombre_pagador","query-pago.sql")'>${lbl:b_paying_name}</th>
			<th class='sortable' onclick='sortBy("ppv_monto_pagar_ml","query-pago.sql")'>${lbl:b_amount_payment_ml}</th>
			<th class='sortable' onclick='sortBy("ppv_monto_pago_ml","query-pago.sql")'>${lbl:b_amount_pay_ml}</th>
			<th class='sortable' onclick='sortBy("ppv_monto_devuelto_ml","query-pago.sql")'>${lbl:b_amount_revers_ml}</th>
			<th class='sortable' onclick='sortBy("ppv_monto_pagar_ma","query-pago.sql")'>${lbl:b_amount_payment_ma}</th>
			<th class='sortable' onclick='sortBy("ppv_monto_pago_ma","query-pago.sql")'>${lbl:b_amount_pay_ma}</th>
			<th class='sortable' onclick='sortBy("ppv_monto_devuelto_ma","query-pago.sql")'>${lbl:b_amount_revers_ma}</th>
		</tr>
	</table>
</form>
<!--codigo de soporte del template-->
<script type="text/javascript">
	var tpl = '${fld:tlc_naturaleza}';
	var lin = '${fld:smn_linea_comercial_id}';	
	var ent =  '${fld:smn_entidad_rf}';	

	onload = function(){ 
			inic();
	} 

	function inic(){
		$('.js-example-basic-single').select2();
		$('.cliente').select2();

		//$('#smn_cliente_id').val(1).change();
		//$('#smn_cliente_id').prop("disabled","false");


		$('.formapago').select2();
		$('.bank_orig').select2();
		$('.bank_dest').select2();
		$('.account_bank').select2();
		$('.rel_pto_venta').select2();

		$('.rel_pto_venta').select2();
		$('.moneda').select2();
		$('.tasa').select2();

		$('#med_pag').hide();
		$('#num_doc').hide();
		$('#num_aut').hide();
		$('#num_dep').hide();
		$('#coin').hide();
		$('#tasa').hide();
		$('#doc_ident').hide();
		$('#nom_pag').hide();

		$('#bancorig').hide();
		$('#bancodesti').hide();
		$('#cuentaban').hide();

		$('#ppv_cuenta_bancaria').prop('disabled','true');
		
		var idc = document.form2.smn_pedido_cabecera_id.value;
		document.getElementById("form2").style.display="none";
		document.getElementById("form3").style.display="none";
		document.form1.smn_sub_centro_facturacion_id.disabled=true;
		document.getElementById("smn_pedido_cabecera_id").disabled=true;
		document.getElementById("pde_cantidad_oferta").disabled=true;
		document.getElementById("pde_monto").disabled=true;
		document.form3.smn_pedido_cabecera_id.value = idc;

		$('#form4').hide();
		$('#ite').hide();
		$('#serv').hide();

		$('#smn_moneda_rf').val(352).change();
				
		habilita_precio();

		document.form1.smn_centro_facturacion_id.value = '${fld:centro}';
		document.form1.smn_centro_facturacion_id.disabled=true;

		var mtx = '${fld:monto}';
		var montox = parseFloat(mtx);
		//alert(montox);
		document.form3.ppv_monto_pagar_ml.value = montox;
		document.form3.ppv_monto_pagar_ml.disabled=true;
		document.form3.ppv_monto_pago_ml.disabled=true;
		document.form3.ppv_monto_devuelto_ml.disabled=true;

		var doc = '${fld:documento}';
		var mon_alt = '${fld:moneda_alterna}';
		//alert("documento: "+doc+" moneda alterna: "+mon_alt);

		if(mon_alt == 'SI'){
			$('#coin').show();
			$('#tasa').show();
		}else{
			$('#coin').hide();
			$('#tasa').hide();
		}
		document.form3.smn_rel_punto_venta_pago_rf.disabled=true;
		document.getElementById('med_pag').style.display="none"
	}

	function cliente(){
		var uri = "/smn_comercial/action/smn_registro/smn_auxiliar_terceros/editor/form?reference=true&source=cliente";
		openDialog("editor20", uri, 650, 580);
	}

	function comprador() {
		var uri = "/smn_comercial/action/smn_registro/smn_pedido_salud_contado/editor_pa/form?reference=true&source=address";
		console.log(uri);
		openDialog("editor_pa", uri, 850, 700);
	}


	function bloquearcombos() {
		var client = document.form1.smn_cliente_id.value;
		//var compr = document.form1.smn_auxiliar_rf_value

		if (client != 0) {
			document.getElementById('smn_auxiliar_rf').disabled=false;
		} else{
			document.getElementById('smn_auxiliar_rf').disabled=false;
			document.getElementById('smn_cliente_id').disabled=false;
		}
	}


	function bloquearcombos1() {
		//var client = document.form1.smn_cliente_id.value;
		var compr = document.form1.smn_auxiliar_rf_value

		if (compr != 0) {
			document.getElementById('smn_cliente_id').disabled=true;
		} else{
			document.getElementById('smn_cliente_id').disabled=false;//
			document.getElementById('smn_auxiliar_rf').disabled=false;
		}
	}
	
	function chgCombo(text,id)
	{	
		document.getElementById(id).value = text;
	}
	
	//configurar formulario para ingresar registro nuevo
	function addNew()
	{
		document.getElementById("formTitle").innerHTML = "${lbl:b_add_record}";
		document.getElementById("grabar").disabled=false;
		//clearForm("form1");
		//setFocusOnForm("form1");
	}
	
	//retorna al estado previo que corresponde
	//al estado actual de la pagina, cada llamada Ajax
	//se encarga de definir cual es la funcion de goBack() que aplica
	function goBack() 
	{
		_goBackFn()			
	}
	
	//restaurar el formulario en caso de error
	function retryAddnewOrEdit() {
		document.getElementById("grabar").disabled=false;
		setFocusOnForm("form1");		
	}

	//restaurar el formulario en caso de error
	function retryAddnewOrEdit2() {
		document.getElementById("grabar").disabled=false;
		setFocusOnForm("form2");		
	}
	

	//restaurar el formulario en caso de error
	function retryAddnewOrEdit3() {
		document.getElementById("grabar").disabled=false;
		setFocusOnForm("form3");		
	}
	
	
	var id = "${fld:id}"

	//grabar el formulario
	function save(){

		if (document.form1.id.value=="")
				return obtenerCentroFact();
	}

	function validafecha(sender){
		var d = new Date();
		var strDate = d.getDate() + "-" + (d.getMonth()+1) + "-" + d.getFullYear();
		
		if (sender!="") {
			if (sender<strDate) {
				alert("La fecha Requerida no puede ser menor a la fecha de hoy");
			}
		}	
	}

	var bdID;
	function setID(id)
	{
		bdID = id;
	}

	//Author     : SIMONE
    //Description: Set first element as selected value
    //Return     : None
    function setElementFirstIndex(id){
        var combo = document.getElementById(id);
        combo.selectedIndex = 0;
    }

	//Author     : SIMONE
	//Description: Insert new value into combo box
	//Return     : None
	function insertComboBox(code, combo, description, field) {
		var valueText = code;
		//alert("value: "+valueText+"campo: "+field);
		if (description != null)
		{
			//valueText = valueText + '' + description;
			valueText = description;
		}
       			 //combo.options[combo.options.length] = new Option(valueText);
		var option = document.createElement("option");
		option.text = valueText; 
		option.value = bdID;

		if (field == 'smn_cliente_id')
		{
			//alert('Añadiendo a cliente en comercial')
			document.form1.smn_cliente_id.add(option, combo.options.length);
			 $("#smn_cliente_id option[value="+ bdID +"]").attr("selected",true);
			//setElementFirstIndex('smn_cliente_id');
		}
		else if (field == 'smn_auxiliar_rf')
		{
			//alert('Añadiendo a comprador en comercial')
			document.form1.smn_auxiliar_rf.add(option, combo.options.length);
			 $("#smn_auxiliar_rf option[value="+ bdID +"]").attr("selected",true);
			//setElementFirstIndex('smn_auxiliar_rf');
		}
	}


	//Author     : SIMONE
	//Description: Add new value to combo box
	//Return     : None
	function addValueToCombo(code, description, field) 
	{
	    var combo = document.getElementById(field);	    
	   insertComboBox(code, combo, description, field);
	}
	
	//Author     : SIMONE
	//Description: Set selected index into combo box
	//Return     : None
	function setSelectedIndex(code, combo, description) 
	{
	    for (var i = 0; i < combo.options.length; i++) 
	    {
			var valueText = code;
			if (description != null)
			{
				valueText = valueText + ' - ' + description;
			}
	        if (combo.options[i].text == valueText) 
	        {
	        	combo.options[i].selected = true;
	            return;
	        }
	    }
	}
	
	//Author     : SIMONE
	//Description: Get text valueof selected index
	//Return     : Text associated to index
	function getSelectedIndex(combo) 
	{
	    for (var i = 0; i < combo.options.length; i++) 
	    {
	        if (combo.options[i].selected == true) 
	        {
	            return combo.options[i].text;
	        }
	    }
	}
	function getIDSelectedIndex(combo) 
	{
	    for (var i = 0; i < combo.options.length; i++) 
	    {
	        if (combo.options[i].selected == true) 
	        {
	            return combo.options[i].value;
	        }
	    }
	}
	
	function setValueComboBox(code, description, field, linked){
		//add valur text to combo
		addValueToCombo(code,description,field);
		var combo = document.getElementById(field);
		var valueText = getSelectedIndex(combo);		
		setSelectedIndex(bdID, combo, valueText); 
	}

			//Author     : SIMONE
	//Description: Add new value to combo box
	//Return     : None
	function addValueToComboAux(code, description, field) 
	{
	    var combo = document.getElementById(field);	    

	    insertComboBoxAux(code, combo, description);
	}

	//Author     : SIMONE
	//Description: Insert new value into combo box
	//Return     : None
	/*function insertComboBox(code, combo, description, field) {
		var valueText = description;
		var bdID = code;	
		var option = document.createElement("option");
		option.text = valueText; 
		option.value = bdID;
		document.form1.cts_auxiliar.add(option, combo.options.length);	
	}*/



	// CODIGO NUEVOOOO VEHICULO 
	//Author     : SIMONE
	//Description: Insert new value into combo box
	//Return     : None
	function insertComboBoxAux(code, combo, description, field) {
		var bdID = code;
		var valueText = description;

		if (description != null)
		{
			 bdID = bdID;
			valueText = description;
			//valueText = valueText + '' + description;
		}
       
       //combo.options[combo.options.length] = new Option(valueText);
		var option = document.createElement("option");
		option.text = valueText; 
		option.value = bdID;
		//document.getElementById('cts_auxiliar').value = bdID;
		// if (field == 'cts_auxiliar')
		// {
			console.log("VALUE: "+bdID);
			//alert('Añadiendo a prospectos en llamadas')
			document.form1.smn_auxiliar_rf.add(option, combo.options.length);
			 $("#smn_auxiliar_rf option[value="+ bdID +"]").attr("selected",true);
			//setElementFirstIndexVeh('cts_auxiliar');
			document.form1.smn_auxiliar_rf.disabled=true;
		// }
		
	}

		//Author     : SIMONE
	//Description: Set selected index into combo box
	//Return     : None
	function setSelectedIndexAux(code, combo, description) 
	{
	    for (var i = 0; i < combo.options.length; i++) 
	    {
			var valueText = code;
			if (description != null)
			{
				valueText = valueText + ' - ' + description;
			}
	        if (combo.options[i].text == valueText) 
	        {
	        	combo.options[i].selected = true;
	            return;
	        }
	    }
	}
	
	//Author     : SIMONE
	//Description: Get text valueof selected index
	//Return     : Text associated to index
	function getSelectedIndexAux(combo) 
	{
	    for (var i = 0; i < combo.options.length; i++) 
	    {
	        if (combo.options[i].selected == true) 
	        {
	            return combo.options[i].text;
	        }
	    }
	}

	function getIDSelectedIndexAux(combo) 
	{
	    for (var i = 0; i < combo.options.length; i++) 
	    {
	        if (combo.options[i].selected == true) 
	        {
	            return combo.options[i].value;
	        }
	    }
	}
	

		//Author     : SIMONE
	//Description: Set value to combo box
	//Parameters : code - it is code associated into each database table 
	//             descripcion - it is description associated into each database table 
	//             field - name combo field
	//             id - identifier retrieved after transaction
	//             linked - flag indicates 'true' when combos are linked and 'false' otherwise
	//Return     : None
	function setValueComboBoxAux(code, description, field, linked)
	{
		//add valur text to combo
		addValueToComboAux(code,description,field);
		//get select object 
		var combo = document.getElementById(field);
		//alert(combo)
		//set element selected to field referenced
		//setSelectedIndexVeh(code,combo, description);
		//set text value to combo field
		var valueText = getSelectedIndexAux(combo);		
		//alert(valueText)
		//get hidden field in order to set any value
		//var combo = document.getElementById(field+'_name');

	//	combo.text=valueText;
		//combo.value=bdID;
		setSelectedIndexAux(bdID, combo, valueText); 
	}
	
    
	function obtenerCentroFact() {
		var centro_fact = document.getElementById("smn_centro_facturacion_id").value;
		var sub_centro_fact = document.getElementById("smn_sub_centro_facturacion_id").value;
		var cliente = document.getElementById("smn_cliente_id").value;
		var comprador = document.getElementById("smn_auxiliar_rf").value; 

		if(comprador == ''){
			comprador=0;
		}

		if (cliente == '') {
			cliente = 0;
		}

		if (centro_fact!=null && centro_fact!="") 
		{
			var uri="${def:actionroot}/getcentrofact?centro_fact=" + centro_fact + "&sub_centro_fact="+ sub_centro_fact +"&cliente="+cliente+"&comprador="+comprador;
			//alert("LLEGO DENTRO DEL IF"+uri);
			return ajaxCall(	
							httpMethod="GET", 
							uri, 
							divResponse=null, 
							divProgress="status", 
							formName="form1", 
							afterResponseFn=null, //function 'setElementFirstIndex' select first element of combo list
							onErrorFn=null);				
		}else{
			alert("Centro de Facturacion vacio por favor verifique sus opciones");
		}
	}

	var geo_id1 = null;
	function chgCombo1(text,id)
	{		
		document.form1.smn_sub_centro_facturacion_id.disabled=false;
		var combo = document.getElementById('smn_centro_facturacion_id');
		var valueCombo = getIDSelectedIndex(combo);
		geo_id1 = valueCombo.split("-").pop().trim();
		
		if (id!=null && id!="") 
		{
			return ajaxCall(	
							httpMethod="GET", 
							uri="${def:actionroot}/getsubcentro?id=" + geo_id1, 
							divResponse=null, 
							divProgress="status", 
							formName="form1", 
							afterResponseFn=setElementFirstIndex('smn_sub_centro_facturacion_id'), //function 'setElementFirstIndex' select first element of combo list
							onErrorFn=null);				
		}
	}


	//var geo_id5 = null;
	function chgComboActivoFijo(id){		
		if (id!=null && id!="") 
		{
			return ajaxCall(	
							httpMethod="GET", 
							uri="${def:actionroot}/getservicio?id=" + id, 
							divResponse=null, 
							divProgress="status", 
							formName="form2", 
							afterResponseFn=setElementFirstIndex('smn_servicios_rf'), //function 'setElementFirstIndex' select first element of combo list
							onErrorFn=null);				
		}
	}


	function concatenaritem(sender, sender2) {
		if ($(sender).is(":checked") ) {

			if($("#smn_descripcion_ingrediente").val()==""){
				$("#smn_descripcion_ingrediente").val($(sender).attr('data-name')+' '+$(sender2).attr('data-precio'));
			}else{
				$("#smn_descripcion_ingrediente").val($("#smn_descripcion_ingrediente").val()+' '+$(sender).attr('data-name')+' '+$(sender2).attr('data-precio'));
				
			}
		}else{
			var dat = $("#smn_descripcion_ingrediente").val();
			if($.trim(dat)==""){
				$("#smn_descripcion_ingrediente").val("");
			}else{
				//alert(" no vacioo");
				$("#smn_descripcion_ingrediente").val($("#smn_descripcion_ingrediente").val().replace($.trim(dat),""));
			}
		}
	}

	function calcularprecioingrediente(sender, sender2) {
		var p_ing =  parseFloat($(sender2).attr('data-precio'));
		var p_orig = parseFloat($("#pde_precio").val());
		var p_total = 0;

		if ($(sender).is(":checked") ) {
				p_total = p_orig + p_ing;	
				//alert(p_total);
				$("#pde_precio").val(p_total);
		} else {
				p_total = p_orig - p_ing;	
				$("#pde_precio").val(p_total.toFixed(2));	
		}
	}

	function calcularmontolocal() {
		var cant = document.getElementById('pde_cantidad_aprobada').value;
		var preml = document.getElementById('pde_precio').value;
		var totalml = 0;

		totalml = cant * preml;
		document.getElementById('pde_monto').value = totalml;
		document.getElementById('pde_monto').disabled = true;
	}

	var geo_id = null;
	function chgCombo2(text,id)
	{		
		document.form2.smn_unidad_medida_rf.disabled=false;
		var combo = document.getElementById('smn_catalogo_item_comercio_id');
		var valueCombo = getIDSelectedIndex(combo);
		geo_id = valueCombo.split("-").pop().trim();

		if (id!=null && id!="") 
		{
			return ajaxCall(	
							httpMethod="GET", 
							uri="${def:actionroot}/getunidadmedida?id=" + geo_id, 
							divResponse=null, 
							divProgress="status", 
							formName="form2", 
							afterResponseFn=setElementFirstIndex('smn_unidad_medida_rf'), //function 'setElementFirstIndex' select first element of combo list
							onErrorFn=null);				
		}
	}

	//Author     : SIMONE
	//Description: Set first element as selected value
	//Return     : None
	function setCheckBox(id)
	{
		setCheckboxValue('smn_ingredientes_id','${fld:smn_ingredientes_id}','form1');
	}


	function recalcular_monto() {
		var id2 = document.getElementById("smn_pedido_cabecera_id").value;
		uri="${def:actionroot}/recalcular_saldos?id2=" + id2
		//alert(uri);
		 ajaxCall(httpMethod="GET", 
						uri,
						divResponse=null, 
						divProgress="status", 
						formName=null, 
						afterResponseFn=null, 
						onErrorFn=null);		
	}


		function recalcular_monto_2() {
		var id2 = document.getElementById("smn_pedido_cabecera_id").value;
		uri="${def:actionroot}/montoapagar3?id2=" + id2
		//alert(uri);
		 ajaxCall(httpMethod="GET", 
						uri,
						divResponse=null, 
						divProgress="status", 
						formName=null, 
						afterResponseFn=null, 
						onErrorFn=null);		
	}


	function updateMontoPedido() {
		var id2 = document.getElementById("smn_pedido_cabecera_id").value;
		uri="${def:actionroot}/montoapagar?id2="+id2;
		//alert(uri);
		ajaxCall(httpMethod="GET", 
					uri, 
					divResponse="response", 
					divProgress="status", 
					formName=null, 
					afterResponseFn=null, 
					onErrorFn=null);
	}

	var geo_id3 = null;
	function chgCombo13(text,id)
	{		
		var combo = document.getElementById('smn_item_rf');
		var valueCombo = getIDSelectedIndex(combo);
		geo_id3 = valueCombo.split("-").pop().trim();
		
		if (id!=null && id!="") 
		{
			return ajaxCall(	
							httpMethod="GET", 
							uri="${def:actionroot}/form/obtener_precio?id=" + geo_id3, 
							divResponse=null, 
							divProgress="status", 
							formName="form2", 
							afterResponseFn=obtener_precio('${fld:precio}'), //function 'setElementFirstIndex' select first element of combo list
							onErrorFn=null);				
		}
	}

	function obtener_precio(id) {
		var precio = document.getElementById("smn_item_rf").value;
	}

	function habilita_precio() {
		var precio = '${fld:selprecio}';
		if (precio == 'SI') {
			document.getElementById("pde_precio").disabled = true;
		}
	}
	
	// function moneda_alterna() {
	// 	var moneda_alterna = '${fld:alterna}';
	// 	if(moneda_alterna=='SI'){
	// 		document.getElementById("moneda").style="";
	// 		document.getElementById("tasa").style="";
	// 		document.getElementById("prec_alt").style="";
	// 		document.getElementById("mont_alt").style="";
	// 	}
	// }

	function calcular_monto_ma() {
		var divisa = document.getElementById('divisa2').value;
		var cant = document.getElementById("pde_cantidad_aprobada").value;
		var precma = document.getElementById("pde_precio_moneda_alterna").value;
		var montoma = "";
		montoma = parseFloat(cant) * parseFloat(precma); 
		//alert(montoma);
		document.getElementById("pde_monto_moneda_alterna").value = montoma;
		document.getElementById("grabar").disabled=false;
	}

	//configurar formulario para ingresar registro nuevo
	function addNew2(){
		document.getElementById("grabar").disabled=false;
		document.getElementById('smn_unidad_medida_rf').value = "";
		document.getElementById('pde_cantidad_pedido').value = "";
		document.getElementById('pde_cantidad_aprobada').value = "";
		document.getElementById('pde_especificaciones_pedido').value = "";
		document.getElementById('pde_precio').value = "";
		document.getElementById('pde_monto').value = "";
		setFocusOnForm("form2");
	}

	function addNew3(){
		document.form3.ppv_numero_documento_forma_pago.value="";
		document.form3.ppv_numero_autorizacion.value="";
		document.form3.ppv_documento_identidad_pagador.value="";
		document.form3.ppv_nombre_pagador.value="";
		document.form3.ppv_monto_pago_ml.value="";
		document.form3.ppv_monto_pagar_ma.value="";
		document.form3.ppv_monto_pago_ma.value="";
		document.form3.ppv_monto_devuelto_ma.value="";
		document.form3.ppv_observacion.value="";
		document.getElementById("grabar").disabled=false;
		setFocusOnForm("form3");
	}

	//mostrar la actualizacion de un registro
	function insert()
	{		
		var it = $('#smn_item_rf').val();
		var se = $('#smn_servicios_rf').val();
		var can = $('#pde_cantidad_pedido').val();
		var tp = $('#pde_naturaleza').val();
		var bar = $('#baremos').val();

		if (tp=='IT') {
			var uri="${def:actionroot}/insertDetalle?cod_itm=" + it + "&cant_ped="+ can + "&baremos=" + bar;
			console.log(uri);
			document.getElementById("grabar").disabled=true;
		}

		if (tp=='SE') {
			var uri="${def:actionroot}/insertDetalle_servicio?cod_itm=" + se + "&cant_ped="+ can + "&BaremosG=" + bar;
			console.log(uri);
			document.getElementById("grabar").disabled=true;
		}

		return ajaxCall(httpMethod="POST", 
						uri,
						divResponse=null, 
						divProgress="status", 
						formName="form2", 
						afterResponseFn=null, 
						onErrorFn=retryAddnewOrEdit2);	
	}


	//mostrar la actualizacion de un registro
	function insert_pago(){		
			var bar = $('#baremos').val();
			var uri="${def:actionroot}/insertPago?baremos=" + bar;
			
			clearErrorMessages();
			document.getElementById("grabar").disabled=true;
			//llamada Ajax...
			return ajaxCall(httpMethod="POST", 
							uri, 
							divResponse=null, 
							divProgress="status", 
							formName="form3", 
							afterResponseFn=null, 
							onErrorFn=retryAddnewOrEdit3);	
	}
	
	//restaurar el formulario en caso de error
	function retryAddnewOrEdit() {
		document.getElementById("grabar").disabled=false;
		setFocusOnForm("form1");		
	}
	
	var id = "${fld:id}"
	
	//grabar el formulario
	function save2()
	{
		
		//determina si es un insert o un update
		if (document.form2.id.value=="")
			return insert();
	}

	//grabar el formulario
	function save3()
	{
		//determina si es un insert o un update
		if (document.form3.id.value=="")
			return insert_pago();
	}

	var geo_id3 = null;
	function requiere_banco(text, id) {
		var combo = document.getElementById('smn_forma_pago_rf');
		var valueCombo = getIDSelectedIndex(combo);
		geo_id3 = valueCombo.split("-").pop().trim();
		
		if (id!=null && id!="") 
		{
			return ajaxCall(	
							httpMethod="GET", 
							uri="${def:actionroot}/getreqbank?id=" + geo_id3, 
							divResponse=null, 
							divProgress="status", 
							formName="form3", 
							afterResponseFn=null, //function 'setElementFirstIndex' select first element of combo list
							onErrorFn=null);				
		}
	}

	function calcularvuelto() {
		var mpagar = document.getElementById('ppv_monto_pagar_ml').value;
		var mpagado = document.getElementById('ppv_monto_pago_ml').value;;
		var mvuelto = 0;
		var fop = document.getElementById('smn_forma_pago_rf');
		var fop_text = fop.options[fop.selectedIndex].text;
		var text_ = fop_text.substring(4,0);
		if (text_== 'EF1') {
			if(mpagado>mpagar){
				alert("El monto del pago no puede ser menor al monto a pagar");
				document.form1.ppv_monto_devuelto_ml.disabled=true;
			}else{
				mvuelto = parseFloat(mpagar) - parseFloat(mpagado);
				document.getElementById('ppv_monto_devuelto_ml').value=mvuelto;
				document.form1.ppv_monto_devuelto_ml.disabled=true;
			}
		}else{
				mvuelto = parseFloat(mpagar) - parseFloat(mpagado);
				document.getElementById('ppv_monto_devuelto_ml').value=mvuelto;
				document.form1.ppv_monto_devuelto_ml.disabled=true;
		}
	}

	function requiere_moneda(doc) {
		ajaxCall(httpMethod="GET", 
					uri="${def:actionroot}/documento?id=" + doc , 
					divResponse=null, 
					divProgress="status", 
					formName=form3, 
					afterResponseFn=null, 
					onErrorFn=null);	
	}
	
	function moneda_alterna() {
		var moneda_alterna = '${fld:alterna}';
		if(moneda_alterna=='SI'){
			$('#coin').show();
			$('#tasa').show();
			$('#prec_alt').show();
			$('#mont_alt').show();
		}else{
			$('#coin').hide();
			$('#tasa').hide();
			$('#prec_alt').hide();
			$('#mont_alt').hide();
		}
	}

	function activarmonedaalterna() {
		var mon = document.getElementById("smn_moneda_rf").value;
		if(mon != 360){
			document.getElementById("mo_pagar").style.display="";
			document.getElementById("mo_devo").style.display="";	
			document.getElementById("mo_pago").style.display="";		
		}else{
			document.getElementById("mo_pagar").style.display="none";
			document.getElementById("mo_devo").style.display="none";	
			document.getElementById("mo_pago").style.display="none";		
		}
	}



	var geo_id2 = null;
	function chgCombo15(text, id) {
		var combo = document.getElementById('smn_forma_pago_rf');
		var valueCombo = getIDSelectedIndex(combo);
		geo_id2 = valueCombo.split("-").pop().trim();
		//alert(geo_id2);
		if (id!=null && id!="") 
		{
			return ajaxCall(	
							httpMethod="GET", 
							uri="${def:actionroot}/getrelptovta?id=" + geo_id2, 
							divResponse=null, 
							divProgress="status", 
							formName="form3", 
							afterResponseFn=setElementFirstIndex('smn_rel_punto_venta_pago_rf'), //function 'setElementFirstIndex' select first element of combo list
							onErrorFn=null);				
		}	
		// body...
	}

	//FUNCION PARA LLEGAR A LA PANTALLA DE PAGOS MEDIANTE EL BOTON PAGAR
	function pago() {
		pagovalidado();
		//alertBox('Desear realizar el pago de este pedido?', '${lbl:b_yes}', '${lbl:b_not}', 'pagovalidado()')
	}

	function pagovalidado() {
		var c_cl = document.getElementById("smn_cliente_id");
		var c_cl_id = document.getElementById("smn_cliente_id").value;
		var cliente = c_cl.options[c_cl.selectedIndex].text;
		var c_co = document.getElementById("smn_auxiliar_rf");
		var comprador = c_co.options[c_co.selectedIndex].text;

			if (c_cl_id =="" && cliente == '[Cualquiera]') {
				document.form3.cliente.value = comprador;
			}else{
				document.form3.cliente.value = cliente;
			}

		var idd = document.form2.smn_pedido_cabecera_id.value;
		if( idd != ''){
			document.getElementById('form2').style.display = "none";
			document.form3.pedido.value = idd;
			document.form3.smn_pedido_cabecera_id.value = idd;
			document.getElementById('form3').style.display = "";
			document.form4.style.display="none";
			recalcular_monto_2();
		}else{
			document.getElementById('form2').style.display = "";
			document.getElementById('form3').style.display = "none";
			//alert('No se pudo generar el pedido por favor intente nuevamente')
		}
	}

	//ejecutar consulta
	function search_2() {
		var id2 = document.getElementById("smn_pedido_cabecera_id").value;
		//alert(id2);
		document.form4.style.display="";
		ajaxCall(httpMethod="GET", 
						uri="${def:actionroot}/search?id2="+id2, 
						divResponse="response", 
						divProgress="status", 
						formName="form4", 
						afterResponseFn=null, 
						onErrorFn=null);
	}

	//ejecutar consulta
	function search_3() {
		var id2 = document.getElementById("smn_pedido_cabecera_id").value;
		//alert(id2);
		document.form5.style.display="";
		ajaxCall(httpMethod="GET", 
						uri="${def:actionroot}/search_pago?id2="+id2, 
						divResponse="response", 
						divProgress="status", 
						formName="form5", 
						afterResponseFn=null, 
						onErrorFn=null);
	}

		//ejecutar consulta
	var geo_id16 = null;
	function chgCombo16(text, id) {
		var combo = document.getElementById('smn_forma_pago_rf');
		var valueCombo = getIDSelectedIndex(combo);
		geo_id16 = valueCombo.split("-").pop().trim();

		if (id!=null && id!="") 
		{
			return ajaxCall(httpMethod="GET", 
						uri="${def:actionroot}/getmonedalterna?id2="+geo_id16, 
						divResponse="response", 
						divProgress="status", 
						formName="form5", 
						afterResponseFn=habilitarCampos(), 
						onErrorFn=null);
		}
	}

	function habilitarCampos() {
		
		if(moneda_alterna=='Si'){
			//alert("Si: "+moneda_alterna);
			$('#mo_pagar').show();
			$('#mo_pago').show();
			$('#mo_devo').show();
			$('#monto_pagar').hide();
			$('#monto_pago').hide();
			$('#monto_vuelto').hide();
		}else{
			//alert("No: "+moneda_alterna);
			$('#mo_pagar').hide();
			$('#mo_pago').hide();
			$('#mo_devo').hide();
			$('#monto_pagar').show();
			$('#monto_pago').show();
			$('#monto_vuelto').show();

		}
	}

	//Este codigo fue creado por SIMONE y ajustado en este crud por Kelvin Marcano
	var geo_idt = null;
	function chgCombo30(text,id)
	{	
		var centro = $('#smn_centro_facturacion_id').val();			
		document.form3.smn_tasa_rf.disabled=false;
		var combo = document.form3.smn_moneda_rf;
		var valueCombo = getIDSelectedIndex(combo);
		//geo_idt = valueCombo.split("-").pop().trim();
		//alert(valueCombo);
		if (id!=null && id!="") 
		{	
			return ajaxCall(	
							httpMethod="GET", 
							uri="${def:actionroot}/gettasa?id=" + valueCombo + "&centro=" +centro, 
							divResponse=null, 
							divProgress="status", 
							formName="form3", 
							afterResponseFn=setElementFirstIndex('smn_tasa_rf'), //function 'setElementFirstIndex' select first element of combo list
							onErrorFn=null); 				
		}
	}

	function seteartasa(text, id) {
		var centro = $('#smn_centro_facturacion_id').val();
			//Este codigo fue creado por SIMONE y ajustado en este crud por Kelvin Marcano
		var combo = document.getElementById('smn_tasa_rf');
		var valueCombo = getIDSelectedIndex(combo);
		//geo_idt = valueCombo.split("-").pop().trim();
		//alert(valueCombo);
		if (id!=null && id!="") 
		{	
			return ajaxCall(	
							httpMethod="GET", 
							uri="${def:actionroot}/gettasa_value?id=" + valueCombo + "&centro=" +centro, 
							divResponse=null, 
							divProgress="status", 
							formName="form3", 
							afterResponseFn=null, //function 'setElementFirstIndex' select first element of combo list
							onErrorFn=null); 				
		}
	}


	function calcular_pago() {
		var divid = document.getElementById('divisa2').value;
		var monto_dolar = document.getElementById('ppv_monto_pagar_ma').value;
		total = monto_dolar * divid;

		document.getElementById('ppv_monto_pago_ml').value = total; 
		document.getElementById('ppv_monto_pago_ml').disabled=true;

		var mp = document.getElementById('ppv_monto_pagar_ma').value;
		var mpp = document.getElementById('ppv_monto_pago_ma').value ;
		$('#ppv_monto_pago_ml').prop("disabled","true");
		total2 =  mpp - mp;

		document.getElementById('ppv_monto_devuelto_ma').value=total2.toFixed(2);
		var m1 = document.getElementById('ppv_monto_pagar_ml').value;
		var m2 = document.getElementById('ppv_monto_pago_ml').value;
		total3 = m1 -  m2;

		document.getElementById('ppv_monto_devuelto_ml').value=total3.toFixed(2);
		var mto_dev_ma = $('#ppv_monto_devuelto_ma').val();
		total4 = divid * mto_dev_ma;

		document.getElementById('ppv_monto_devuelto_ml').value=total4.toFixed(2);
		$('#ppv_monto_devuelto_ma').prop("disabled","true");
	}


	var geo_id4 = null;
	function chgComboItem(text, id){		

			var combo = document.getElementById('smn_item_rf');
		var valueCombo = getIDSelectedIndex(combo);
			geo_id4 = valueCombo.split("-").pop().trim();
			//alert(geo_id4);

		if (id!=null && id!="") 
		{
			return ajaxCall(	
							httpMethod="GET", 
							uri="${def:actionroot}/getitem?id=" + geo_id4, 
							divResponse=null, 
							divProgress="status", 
							formName="form2", 
							afterResponseFn=setElementFirstIndex('smn_item_rf'), //function 'setElementFirstIndex' select first element of combo list
							onErrorFn=null);				
		}
	}

	var geo_id5 = null;
	function chgComboServicio(text, id){	

		var combo = document.getElementById('smn_servicios_rf');
		var valueCombo = getIDSelectedIndex(combo);
		geo_id5 = valueCombo.split("-").pop().trim();
		//alert(geo_id5);

		if (id!=null && id!="") 
		{
			return ajaxCall(	
							httpMethod="GET", 
							uri="${def:actionroot}/getservicio?id=" + geo_id5, 
							divResponse=null, 
							divProgress="status", 
							formName="form2", 
							afterResponseFn=setElementFirstIndex('smn_servicios_rf'), //function 'setElementFirstIndex' select first element of combo list
							onErrorFn=null);				
		}
	}


			//var geo_id5 = null;
	function chgComboItem_linea(id, id2, id3){	
	//alert("ITEM: "+id);	
		if (id!=null && id!="") 
		{
			return ajaxCall(	
							httpMethod="GET", 
							uri="${def:actionroot}/getitem?id=" + id + "&entidad="+id2+"&baremos="+id3, 
							divResponse=null, 
							divProgress="status", 
							formName="form2", 
							afterResponseFn=setElementFirstIndex('smn_item_rf'), //function 'setElementFirstIndex' select first element of combo list
							onErrorFn=null);				
		}
	}


		//var geo_id5 = null;
	function chgComboServicio_linea(id, id2, id3){	

	//alert("SERVICIO: "+id);	
		if (id!=null && id!="") 
		{
			return ajaxCall(	
							httpMethod="GET", 
							uri="${def:actionroot}/getservicio?id=" + id + "&entidad="+id2+"&baremos="+id3, 
							divResponse=null, 
							divProgress="status", 
							formName="form2", 
							afterResponseFn=setElementFirstIndex('smn_servicios_rf'), //function 'setElementFirstIndex' select first element of combo list
							onErrorFn=null);				
		}
	}

	function cambiartipo() {
		var tipo = document.getElementById("pde_naturaleza").value;
		var lin = document.getElementById("linea").value;
		var ent = document.getElementById("empresa").value;
			var bar = document.getElementById("baremos").value;
		//alert(ent);
		if(tipo=="IT"){
			chgComboItem_linea(lin, ent, bar);
			$('#ite').show();
			$('#act').hide();
			$('#serv').hide();
		}

		 if(tipo=="SE"){
			chgComboServicio_linea(lin, ent, bar);
			$('#ite').hide();
			$('#serv').show();
			$('#act').hide();
		}

		if(tipo=="AF"){
			$('#serv').hide();
			$('#act').show();
			$('#ite').hide();
		}

		if(tipo == ""){
			$('#act').hide();
			$('#serv').hide();
			$('#ite').hide()

		}
	}

	var geo_id3 = null;
	function obtenerprecio(text,id)
	{		
		var centro = $('#smn_centro_facturacion_id').val();
		$('#centro').val(centro);
		var combo = document.getElementById('smn_item_rf');
		var valueCombo = getIDSelectedIndex(combo);
		geo_id3 = valueCombo.split("-").pop().trim();

		let current_datetime = new Date();
		let formatted_date = current_datetime.getDate() + "-" + (current_datetime.getMonth() + 1) + "-" + current_datetime.getFullYear();
		
		if (id!=null && id!="") 
		{
			return ajaxCall(	
							httpMethod="GET", 
							uri="${def:actionroot}/form/obtener_precio?id=" + geo_id3 + "&fecha="+formatted_date + "&centro=" +centro, 
							divResponse=null, 
							divProgress="status", 
							formName="form2", 
							afterResponseFn=null, //function 'setElementFirstIndex' select first element of combo list afterResponseFn=obtener_precio('${fld:precio}')
							onErrorFn=null);				
		}
	}

	var geo_id4 = null;
	function obtenerprecio2(text,id)
	{	
		var centro = $('#smn_centro_facturacion_id').val();	
		$('#centro').val(centro);
		var combo = document.getElementById('smn_servicios_rf');
		var valueCombo = getIDSelectedIndex(combo);
		geo_id4 = valueCombo.split("-").pop().trim();

		let current_datetime = new Date();
		let formatted_date = current_datetime.getDate() + "-" + (current_datetime.getMonth() + 1) + "-" + current_datetime.getFullYear();

		if (id!=null && id!="") 
		{
			return ajaxCall(	
							httpMethod="GET", 
							uri="${def:actionroot}/form/obtener_precio2?id=" + geo_id4 + "&fecha="+formatted_date + "&centro=" + centro, 
							divResponse=null, 
							divProgress="status", 
							formName="form2", 
							afterResponseFn=obtener_precio('${fld:precio}'), //function 'setElementFirstIndex' select first element of combo list
							onErrorFn=null);				
		}
	}

	function verificarcantidad() {
		var item = $('#smn_item_rf').val();
		var ser = $('#smn_servicios_rf').val(); //document.getElementById("smn_item_rf").value;
		var cant = $('#pde_cantidad_pedido').val();//document.getElementById("pde_cantidad_pedido").value;
		var tp = $('#pde_naturaleza').val();

		if (tp == 'SE') {
			pasar_cantidad();
		}
		if (tp == 'IT') {
			var uri="${def:actionroot}/consultarexistencia?id=" + item + "&cantidad_pedido="+cant;
		}

		if (item!=null && item!="") 
		{
			return ajaxCall(	
							httpMethod="GET", 
							uri, 
							divResponse=null, 
							divProgress="status", 
							formName="form2", 
							afterResponseFn=null, 
							onErrorFn=null);				
		}
	}

	function pasar_cantidad() {
		var cantpedido = document.getElementById("pde_cantidad_pedido").value;
		var precio = document.getElementById('pde_precio').value;
		var divisa2 = document.getElementById('divisa2').value;
		console.log("divisa2: "+divisa2);
		document.getElementById("pde_cantidad_aprobada").value = cantpedido;

		if (divisa2 == "") {
			monto = parseFloat(precio) * cantpedido;
			document.form2.pde_precio.value = monto;
			document.form2.pde_monto.value = monto;
		}else{
			pasar_cantidad_ma();
		}	
	}

	function pasar_cantidad_ma() {
		var cantpedido = document.getElementById("pde_cantidad_pedido").value;
		var precioma = document.getElementById('pde_precio_moneda_alterna').value;
		var divisa2 = document.getElementById('divisa2').value;
		document.getElementById("pde_cantidad_aprobada").value = cantpedido;

		var prma = cantpedido * parseFloat(precioma);
		document.getElementById("pde_monto_moneda_alterna").value = prma;

		console.log(divisa2);
		var mtol = parseFloat(prma) * divisa2;
		console.log(mtol);
		document.getElementById("pde_monto").value = mtol.toFixed(2);
	}

	function calcular_monto() {
		
		var cantidad = $('#pde_cantidad_pedido').val();
		var precio = $('#pde_precio').val();

		var mt = $('#pde_monto').val();

		if (mt != "") {
			document.getElementById("pde_monto").value = "";
			monto = cantidad * parseFloat(precio);
		}

	 	document.getElementById("pde_monto").value = monto;
	}

	function proceso() {
		var id2 = document.getElementById("smn_pedido_cabecera_id").value;
		alertBox('Desea pagar este pedido?', '${lbl:b_yes}', '${lbl:b_not}', 'actualizar_status(' + id2 + ')')
	}

	function actualizar_status(id2) {
			
			ajaxCall(httpMethod="POST", 
								uri="${def:actionroot}/change_status?id2=" + id2,
								divResponse=null, 
								divProgress="status", 
								formName=null, 
								afterResponseFn=null, 
								onErrorFn=null);	

	}

	function deleteDetalle(id) {
		ajaxCall(httpMethod="GET", 
								uri="${def:actionroot}/deleteDet?id=" + id,
								divResponse=null, 
								divProgress="status", 
								formName=null, 
								afterResponseFn=null, 
								onErrorFn=null);	
		// body...
	}


	function deletePago(id) {
		ajaxCall(httpMethod="GET", 
								uri="${def:actionroot}/deletePago?id=" + id,
								divResponse=null, 
								divProgress="status", 
								formName=null, 
								afterResponseFn=null, 
								onErrorFn=null);	
		// body...
	}


	var geo_idt = null;
	function chgCombo_bancaria(text,id)
	{				
		document.form1.ppv_cuenta_bancaria.disabled=false;
		var combo = document.getElementById('ppv_banco_destino');
		var valueCombo = getIDSelectedIndex(combo);
		geo_id1 = valueCombo.split("-").pop().trim();


		//geo_idt = valueCombo.split("-").pop().trim();
		//alert(valueCombo);
		if (id!=null && id!="") 
		{	
			return ajaxCall(	
							httpMethod="GET", 
							uri="${def:actionroot}/getcuentabancaria?id=" + geo_id1, 
							divResponse=null, 
							divProgress="status", 
							formName="form3", 
							afterResponseFn=setElementFirstIndex('ppv_cuenta_bancaria'), //function 'setElementFirstIndex' select first element of combo list
							onErrorFn=null); 				
		}
	}

	//$("#tabla4").remove();
	function updateMontoPedido() {
				//setTimeout(updateMontoPedido(id_cab), 5000); parent.setFocusOnForm("form2");

		var id = $('#smn_pedido_cabecera_id').val();
		uri="${def:actionroot}/montoapagar?id2=" + id;
		//alert(uri);
		ajaxCall(httpMethod="GET", 
					uri, 
					divResponse="response", 
					divProgress="status", 
					formName=null, 
					afterResponseFn=null, 
					onErrorFn=null);
	}


</script>	
</body>
</html>
